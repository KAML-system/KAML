<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© - Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙƒÙˆÙŠØªÙŠØ© Ù„Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .logo-container {
            margin-bottom: 20px;
        }

        .logo-container img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid white;
            background: white;
            padding: 5px;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header h2 {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 300;
        }

        .form-container {
            padding: 40px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙƒØªØ§Ø¨Ø© */
        .editable-select-container {
            position: relative;
        }

        .editable-select {
            position: relative;
        }

        .editable-select input {
            padding-right: 40px;
        }

        .editable-select::after {
            content: 'â–¼';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            pointer-events: none;
        }

        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .dropdown-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .dropdown-option:hover {
            background-color: #f8f9fa;
        }

        .dropdown-option.selected {
            background-color: #3b82f6;
            color: white;
        }

        .error-message {
            color: #dc3545;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .success-message {
            color: #28a745;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .file-upload {
            border: 2px dashed #e9ecef;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: #f8f9fa;
        }

        .file-upload:hover {
            border-color: #3b82f6;
            background: #f0f9ff;
        }

        .file-upload.dragover {
            border-color: #3b82f6;
            background: #f0f9ff;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-text {
            color: #6b7280;
            font-size: 14px;
        }

        .file-list {
            margin-top: 15px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .file-item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-item-name {
            font-size: 14px;
            color: #333;
        }

        .file-item-size {
            font-size: 12px;
            color: #6b7280;
        }

        .remove-file {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 12px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .back-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 15px;
        }

        .back-btn:hover {
            background: #4b5563;
        }

        .required {
            color: #dc3545;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .password-strength {
            margin-top: 5px;
            font-size: 12px;
        }

        .strength-weak { color: #dc3545; }
        .strength-medium { color: #ffc107; }
        .strength-strong { color: #28a745; }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .form-container {
                padding: 20px;
            }
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .modal-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 15px;
        }

        .modal-message {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-highlight {
            background: #f0f9ff;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #3b82f6;
        }

        .modal-btn {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="logo.jpeg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ù…Ø¹ÙŠØ©" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCA3MCA3MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjcwIiBoZWlnaHQ9IjcwIiBmaWxsPSIjMUUzQThBIiByeD0iMzUiLz4KPHN2ZyB4PSIxNSIgeT0iMTUiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xOS40MyA5LjU2Yy0uNTMtLjUzLTEuMjUtLjgzLTItLjgzSDYuNTdjLS43NSAwLTEuNDcuMy0yIC44M3MtLjgzIDEuMjUtLjgzIDJWMTljMCAuNzUuMyAxLjQ3LjgzIDJzMS4yNS44MyAyIC44M2gxMC44NmMuNzUgMCAxLjQ3LS4zIDItLjgzcy44My0xLjI1LjgzLTJWMTEuNTZjMC0uNzUtLjMtMS40Ny0uODMtMnoiLz4KPC9zdmc+Cjwvc3ZnPgo='">
            </div>
            <h1>Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙƒÙˆÙŠØªÙŠØ© Ù„Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©</h1>
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
        </div>

        <div class="form-container">
            <form id="registrationForm">
                <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© -->
                <div class="section-title">
                    ğŸ‘¤ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="firstNameAr">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ (Ø¹Ø±Ø¨ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="firstNameAr" name="firstNameAr" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="firstNameEn">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="firstNameEn" name="firstNameEn" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="middleNameAr">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø· (Ø¹Ø±Ø¨ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="middleNameAr" name="middleNameAr" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="middleNameEn">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆØ³Ø· (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="middleNameEn" name="middleNameEn" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastNameAr">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© (Ø¹Ø±Ø¨ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="lastNameAr" name="lastNameAr" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastNameEn">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ) <span class="required">*</span></label>
                        <input type="text" id="lastNameEn" name="lastNameEn" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="civilId">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ <span class="required">*</span></label>
                        <input type="text" id="civilId" name="civilId" required maxlength="12" pattern="[0-9]{12}">
                        <div class="error-message" id="civilIdError">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                        <div class="success-message" id="civilIdSuccess">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ Ù…ØªØ§Ø­</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ <span class="required">*</span></label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† -->
                <div class="section-title">
                    ğŸ“§ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù†
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="area">Ø§Ù„Ù…Ù†Ø·Ù‚Ø© <span class="required">*</span></label>
                        <div class="editable-select-container">
                            <div class="editable-select">
                                <input type="text" id="area" name="area" required placeholder="Ø§Ø®ØªØ± Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
                                <div class="dropdown-options" id="areaOptions"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ <span class="required">*</span></label>
                        <textarea id="address" name="address" rows="3" required placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„ØªÙØµÙŠÙ„"></textarea>
                    </div>
                </div>

                <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ© -->
                <div class="section-title">
                    ğŸ’¼ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‡Ù†ÙŠØ©
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="jobTitle">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ <span class="required">*</span></label>
                        <input type="text" id="jobTitle" name="jobTitle" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="workplace">Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù…Ù„ <span class="required">*</span></label>
                        <div class="editable-select-container">
                            <div class="editable-select">
                                <input type="text" id="workplace" name="workplace" required placeholder="Ø§Ø®ØªØ± Ø£Ùˆ Ø§ÙƒØªØ¨ Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù…Ù„">
                                <div class="dropdown-options" id="workplaceOptions"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
                <div class="section-title">
                    ğŸ” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… <span class="required">*</span></label>
                        <input type="text" id="username" name="username" required minlength="4">
                        <div class="error-message" id="usernameError">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                        <div class="success-message" id="usernameSuccess">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ØªØ§Ø­</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <span class="required">*</span></label>
                        <input type="password" id="password" name="password" required minlength="6">
                        <div class="password-strength" id="passwordStrength"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <span class="required">*</span></label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required minlength="6">
                        <div class="error-message" id="passwordError">ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©</div>
                        <div class="success-message" id="passwordSuccess">ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©</div>
                    </div>
                </div>

                <!-- Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª -->
                <div class="section-title">
                    ğŸ“ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                </div>
                
                <div class="form-group full-width">
                    <label>Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© <span class="required">*</span></label>
                    <div class="file-upload" onclick="document.getElementById('personalPhoto').click()">
                        <input type="file" id="personalPhoto" accept="image/*" required>
                        <div class="file-upload-text">
                            ğŸ“· Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©<br>
                            <small>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª - Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©: JPG, PNG</small>
                        </div>
                    </div>
                    <div class="file-list" id="personalPhotoList"></div>
                </div>
                
                <div class="form-group full-width">
                    <label>ØµÙˆØ±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ <span class="required">*</span></label>
                    <div class="file-upload" onclick="document.getElementById('civilIdPhoto').click()">
                        <input type="file" id="civilIdPhoto" accept="image/*" required>
                        <div class="file-upload-text">
                            ğŸ†” Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ<br>
                            <small>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª - Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©: JPG, PNG</small>
                        </div>
                    </div>
                    <div class="file-list" id="civilIdPhotoList"></div>
                </div>
                
                <div class="form-group full-width">
                    <label>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª</label>
                    <div class="file-upload" onclick="document.getElementById('certificates').click()">
                        <input type="file" id="certificates" accept=".pdf,.jpg,.jpeg,.png" multiple>
                        <div class="file-upload-text">
                            ğŸ“ Ø§Ù†Ù‚Ø± Ù„Ø±ÙØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª<br>
                            <small>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª Ù„ÙƒÙ„ Ù…Ù„Ù - Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©: PDF, JPG, PNG</small>
                        </div>
                    </div>
                    <div class="file-list" id="certificatesList"></div>
                </div>

                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <div style="text-align: center; margin-top: 40px;">
                    <button type="button" class="back-btn" onclick="window.location.href='index.html'">
                        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </button>
                    <button type="submit" class="submit-btn" id="submitBtn">
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©
                    </button>
                </div>
                
                <div class="loading" id="loadingDiv">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                </div>
            </form>
        </div>
    </div>

    <!-- Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„ØªØ£ÙƒÙŠØ¯ -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">âœ…</div>
            <div class="modal-title">ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</div>
            <div class="modal-message">
                ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø¨Ù†Ø¬Ø§Ø­. Ø³ØªØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ³ÙŠØªÙ… Ø¥Ø´Ø¹Ø§Ø±Ùƒ Ø¨Ø§Ù„Ù†ØªÙŠØ¬Ø©.
            </div>
            <div class="modal-highlight">
                <strong>Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹:</strong><br>
                Ø§Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ:<br>
                <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> <span id="savedUsername"></span><br>
                <strong>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</strong> Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§
            </div>
            <button class="modal-btn" onclick="closeModal()">ÙÙ‡Ù…Øª</button>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBL5Ej4VvdJJDl_8vG5KqF8eJ9X8yF4Abc",
            authDomain: "kaml-membership-system.firebaseapp.com",
            projectId: "kaml-membership-system",
            storageBucket: "kaml-membership-system.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef123456789"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ÙƒÙˆÙŠØªÙŠØ©
        const kuwaitAreas = [
            'Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ', 'Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡', 'Ø­ÙˆÙ„ÙŠ', 'Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„ÙƒØ¨ÙŠØ±', 'Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©', 'Ø§Ù„Ø¹Ø§ØµÙ…Ø©',
            'Ø§Ù„Ø³Ø§Ù„Ù…ÙŠØ©', 'Ø§Ù„ÙØ­ÙŠØ­ÙŠÙ„', 'Ø§Ù„Ù…Ù†Ù‚Ù', 'Ø§Ù„Ø±Ù‚Ø©', 'Ø§Ù„ÙÙ†Ø·Ø§Ø³', 'Ø£Ø¨Ùˆ Ø­Ù„ÙŠÙØ©',
            'Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©', 'Ø§Ù„Ø®ÙŠØ±Ø§Ù†', 'Ø§Ù„ÙˆÙØ±Ø©', 'Ø§Ù„Ù†Ø¹ÙŠÙ…', 'Ø§Ù„Ø¶Ø¬ÙŠØ¬', 'Ø§Ù„Ø²ÙˆØ±',
            'ÙƒÙŠÙØ§Ù†', 'Ø§Ù„Ø´Ø§Ù…ÙŠØ©', 'Ø§Ù„Ø¯Ø¹ÙŠØ©', 'Ø¨ÙŠØ§Ù†', 'Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ©', 'Ø§Ù„Ø³Ø±Ø©',
            'Ø§Ù„Ø±Ù…ÙŠØ«ÙŠØ©', 'Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡', 'Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡', 'Ø§Ù„ÙÙŠØ­Ø§Ø¡', 'Ø§Ù„Ø®Ø§Ù„Ø¯ÙŠØ©', 'Ø§Ù„Ø¯ÙˆØ­Ø©',
            'Ø§Ù„Ø¯Ø³Ù…Ø©', 'Ø§Ù„ØµÙˆØ§Ø¨Ø±', 'Ø§Ù„Ø¹Ø¯ÙŠÙ„ÙŠØ©', 'Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©', 'Ù‚Ø±Ø·Ø¨Ø©', 'Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ',
            'ØºØ±Ù†Ø§Ø·Ø©', 'Ø§Ù„ÙØ±Ø¯ÙˆØ³', 'Ø¬Ù„ÙŠØ¨ Ø§Ù„Ø´ÙŠÙˆØ®', 'Ø§Ù„Ø±Ø§Ø¨ÙŠØ©', 'Ø§Ù„Ø£Ù†Ø¯Ù„Ø³', 'Ø§Ù„Ø®ÙŠØ·Ø§Ù†',
            'Ø§Ù„Ø±Ø­Ø§Ø¨', 'Ø§Ù„Ø¹Ù…Ø±ÙŠØ©', 'Ø¥Ø´Ø¨ÙŠÙ„ÙŠØ©', 'Ø§Ù„Ø¶Ø§Ø­ÙŠØ©', 'Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ®Ø§Øª', 'Ø§Ù„Ø¯ÙˆØ­Ø©',
            'Ø§Ù„Ø´ÙˆÙŠØ®', 'Ø§Ù„Ù‚Ø¨Ù„Ø©', 'Ø§Ù„Ù…Ø±Ù‚Ø§Ø¨', 'Ø¯Ø³Ù…Ø§Ù†', 'Ø¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø±', 'Ø§Ù„ØµÙØ§Ø©'
        ];

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ù‡Ø§Øª Ø§Ù„Ø¹Ù…Ù„
        const workplaces = [
            'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹',
            'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¹Ø¯Ù„', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø£Ø´ØºØ§Ù„ Ø§Ù„Ø¹Ø§Ù…Ø©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„Ù…Ø§Ø¡',
            'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù†ÙØ·', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¬Ø§Ø±Ø© ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù…',
            'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù„ÙŠ', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø£ÙˆÙ‚Ø§Ù ÙˆØ§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©', 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©',
            'Ù…Ø³ØªØ´ÙÙ‰ Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„ÙƒØ¨ÙŠØ±', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ù…ÙŠØ±', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©',
            'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ØµØ¨Ø§Ø­', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø±Ø§Ø²ÙŠ', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ø¨Ù† Ø³ÙŠÙ†Ø§',
            'Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„ÙƒÙˆÙŠØª', 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨', 'Ù…Ø¹Ù‡Ø¯ Ø§Ù„ÙƒÙˆÙŠØª Ù„Ù„Ø£Ø¨Ø­Ø§Ø« Ø§Ù„Ø¹Ù„Ù…ÙŠØ©',
            'Ø´Ø±ÙƒØ© Ù†ÙØ· Ø§Ù„ÙƒÙˆÙŠØª', 'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¨ØªØ±ÙˆÙ„ Ø§Ù„ÙƒÙˆÙŠØªÙŠØ©', 'Ø¨Ù†Ùƒ Ø§Ù„ÙƒÙˆÙŠØª Ø§Ù„ÙˆØ·Ù†ÙŠ',
            'Ø¨Ù†Ùƒ Ø§Ù„Ø®Ù„ÙŠØ¬', 'Ø¨Ù†Ùƒ Ø¨Ø±Ù‚Ø§Ù†', 'Ø¨ÙŠØª Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ÙƒÙˆÙŠØªÙŠ', 'Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ'
        ];

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙƒØªØ§Ø¨Ø©
        function setupEditableSelect(inputId, optionsId, dataArray) {
            const input = document.getElementById(inputId);
            const optionsDiv = document.getElementById(optionsId);
            
            input.addEventListener('focus', () => {
                showOptions(optionsDiv, dataArray, input);
            });
            
            input.addEventListener('input', () => {
                const value = input.value.toLowerCase();
                const filtered = dataArray.filter(item => 
                    item.toLowerCase().includes(value)
                );
                showOptions(optionsDiv, filtered, input);
            });
            
            document.addEventListener('click', (e) => {
                if (!input.contains(e.target) && !optionsDiv.contains(e.target)) {
                    optionsDiv.style.display = 'none';
                }
            });
        }

        function showOptions(optionsDiv, dataArray, input) {
            optionsDiv.innerHTML = '';
            dataArray.forEach(item => {
                const option = document.createElement('div');
                option.className = 'dropdown-option';
                option.textContent = item;
                option.addEventListener('click', () => {
                    input.value = item;
                    optionsDiv.style.display = 'none';
                });
                optionsDiv.appendChild(option);
            });
            optionsDiv.style.display = dataArray.length > 0 ? 'block' : 'none';
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ
        async function checkCivilIdExists(civilId) {
            try {
                const snapshot = await db.collection('membershipApplications')
                    .where('civilId', '==', civilId)
                    .get();
                return !snapshot.empty;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ:', error);
                return false;
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        async function checkUsernameExists(username) {
            try {
                const snapshot = await db.collection('membershipApplications')
                    .where('username', '==', username)
                    .get();
                return !snapshot.empty;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                return false;
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function checkPasswordStrength(password) {
            const strengthDiv = document.getElementById('passwordStrength');
            let strength = 0;
            let message = '';
            
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            if (strength < 2) {
                message = 'Ø¶Ø¹ÙŠÙØ©';
                strengthDiv.className = 'password-strength strength-weak';
            } else if (strength < 4) {
                message = 'Ù…ØªÙˆØ³Ø·Ø©';
                strengthDiv.className = 'password-strength strength-medium';
            } else {
                message = 'Ù‚ÙˆÙŠØ©';
                strengthDiv.className = 'password-strength strength-strong';
            }
            
            strengthDiv.textContent = `Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${message}`;
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
        function handleFileUpload(inputId, listId, maxSize = 5 * 1024 * 1024) {
            const input = document.getElementById(inputId);
            const list = document.getElementById(listId);
            
            input.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                list.innerHTML = '';
                
                files.forEach((file, index) => {
                    if (file.size > maxSize) {
                        alert(`Ø§Ù„Ù…Ù„Ù ${file.name} ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ ${maxSize / (1024 * 1024)} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª`);
                        return;
                    }
                    
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <div class="file-item-info">
                            <span class="file-item-name">ğŸ“„ ${file.name}</span>
                            <span class="file-item-size">(${(file.size / 1024).toFixed(1)} KB)</span>
                        </div>
                        <button type="button" class="remove-file" onclick="removeFile('${inputId}', ${index})">Ã—</button>
                    `;
                    list.appendChild(fileItem);
                });
            });
        }

        function removeFile(inputId, index) {
            const input = document.getElementById(inputId);
            const dt = new DataTransfer();
            const files = Array.from(input.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            input.files = dt.files;
            input.dispatchEvent(new Event('change'));
        }

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        async function submitForm(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loadingDiv = document.getElementById('loadingDiv');
            
            submitBtn.disabled = true;
            loadingDiv.style.display = 'block';
            
            try {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const civilId = document.getElementById('civilId').value;
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
                if (password !== confirmPassword) {
                    document.getElementById('passwordError').style.display = 'block';
                    throw new Error('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©');
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ
                if (await checkCivilIdExists(civilId)) {
                    document.getElementById('civilIdError').style.display = 'block';
                    throw new Error('Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (await checkUsernameExists(username)) {
                    document.getElementById('usernameError').style.display = 'block';
                    throw new Error('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                }
                
                // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                const formData = new FormData(document.getElementById('registrationForm'));
                const applicationData = {};
                
                for (let [key, value] of formData.entries()) {
                    if (key !== 'personalPhoto' && key !== 'civilIdPhoto' && key !== 'certificates') {
                        applicationData[key] = value;
                    }
                }
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
                const attachments = [];
                
                // Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
                const personalPhoto = document.getElementById('personalPhoto').files[0];
                if (personalPhoto) {
                    const photoBase64 = await fileToBase64(personalPhoto);
                    attachments.push({
                        name: 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©',
                        type: 'personal_photo',
                        url: photoBase64,
                        size: personalPhoto.size
                    });
                }
                
                // ØµÙˆØ±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ
                const civilIdPhoto = document.getElementById('civilIdPhoto').files[0];
                if (civilIdPhoto) {
                    const civilIdBase64 = await fileToBase64(civilIdPhoto);
                    attachments.push({
                        name: 'ØµÙˆØ±Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ',
                        type: 'civil_id',
                        url: civilIdBase64,
                        size: civilIdPhoto.size
                    });
                }
                
                // Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
                const certificates = document.getElementById('certificates').files;
                for (let i = 0; i < certificates.length; i++) {
                    const cert = certificates[i];
                    const certBase64 = await fileToBase64(cert);
                    attachments.push({
                        name: cert.name,
                        type: 'certificate',
                        url: certBase64,
                        size: cert.size
                    });
                }
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                applicationData.attachments = attachments;
                applicationData.status = 'pending';
                applicationData.submissionDate = new Date().toISOString();
                applicationData.id = Date.now().toString();
                
                // Ø­ÙØ¸ ÙÙŠ Firebase
                await db.collection('membershipApplications').doc(applicationData.id).set(applicationData);
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                document.getElementById('savedUsername').textContent = username;
                document.getElementById('successModal').style.display = 'block';
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                loadingDiv.style.display = 'none';
            }
        }

        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
            window.location.href = 'index.html';
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
            setupEditableSelect('area', 'areaOptions', kuwaitAreas);
            setupEditableSelect('workplace', 'workplaceOptions', workplaces);
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
            handleFileUpload('personalPhoto', 'personalPhotoList');
            handleFileUpload('civilIdPhoto', 'civilIdPhotoList');
            handleFileUpload('certificates', 'certificatesList', 10 * 1024 * 1024);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ
            document.getElementById('civilId').addEventListener('blur', async function() {
                const civilId = this.value;
                if (civilId.length === 12) {
                    const exists = await checkCivilIdExists(civilId);
                    if (exists) {
                        document.getElementById('civilIdError').style.display = 'block';
                        document.getElementById('civilIdSuccess').style.display = 'none';
                    } else {
                        document.getElementById('civilIdError').style.display = 'none';
                        document.getElementById('civilIdSuccess').style.display = 'block';
                    }
                }
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('username').addEventListener('blur', async function() {
                const username = this.value;
                if (username.length >= 4) {
                    const exists = await checkUsernameExists(username);
                    if (exists) {
                        document.getElementById('usernameError').style.display = 'block';
                        document.getElementById('usernameSuccess').style.display = 'none';
                    } else {
                        document.getElementById('usernameError').style.display = 'none';
                        document.getElementById('usernameSuccess').style.display = 'block';
                    }
                }
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            document.getElementById('password').addEventListener('input', function() {
                checkPasswordStrength(this.value);
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
            document.getElementById('confirmPassword').addEventListener('input', function() {
                const password = document.getElementById('password').value;
                const confirmPassword = this.value;
                
                if (confirmPassword && password !== confirmPassword) {
                    document.getElementById('passwordError').style.display = 'block';
                    document.getElementById('passwordSuccess').style.display = 'none';
                } else if (confirmPassword && password === confirmPassword) {
                    document.getElementById('passwordError').style.display = 'none';
                    document.getElementById('passwordSuccess').style.display = 'block';
                }
            });
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            document.getElementById('registrationForm').addEventListener('submit', submitForm);
        });
    </script>
</body>
</html>

